<!DOCTYPE html>
<html>
<head>
    <title>Leo Registration Search</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        input, select, button { padding: 10px; margin: 5px; }
        table { border-collapse: collapse; margin-top: 20px; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 10px; text-align: left; }
        th { background-color: #f4f4f4; }
    </style>
</head>
<body>

<h2>Search Leo Registration</h2>
<input type="text" id="searchInput" placeholder="Enter keyword">
<select id="columnSelect">
    <option value="all">All Columns</option>
</select>
<button onclick="search()">Search</button>

<div id="result"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
let data = [];

// Load CSV
Papa.parse("Registrations.csv", {
    download: true,
    header: true,
    complete: function(results) {
        data = results.data.filter(row => Object.values(row).some(cell => cell)); // Remove empty rows
        console.log("CSV loaded:", data);

        // Populate column selector
        const columnSelect = document.getElementById('columnSelect');
        const headers = results.meta.fields;

        headers.forEach(header => {
            const option = document.createElement('option');
            option.value = header;
            option.textContent = header;
            columnSelect.appendChild(option);
        });
    }
});

function search() {
    const keyword = document.getElementById('searchInput').value.trim().toLowerCase();
    const selectedColumn = document.getElementById('columnSelect').value;
    const output = document.getElementById('result');

    if (!keyword) {
        output.innerHTML = "<p>Please enter a keyword to search.</p>";
        return;
    }

    let results = [];

    if (selectedColumn === 'all') {
        results = data.filter(row =>
            Object.values(row).some(val => val && val.toLowerCase().includes(keyword))
        );
    } else {
        results = data.filter(row =>
            row[selectedColumn] && row[selectedColumn].toLowerCase().includes(keyword)
        );
    }

    if (results.length > 0) {
        let html = '<table><tr>';
        for (const key in results[0]) {
            html += `<th>${key}</th>`;
        }
        html += '</tr>';

        for (const row of results) {
            html += '<tr>';
            for (const key in row) {
                html += `<td>${row[key] || '-'}</td>`;
            }
            html += '</tr>';
        }

        html += '</table>';
        output.innerHTML = html;
    } else {
        output.innerHTML = "<p>No matching records found.</p>";
    }
}
</script>

</body>
</html>
